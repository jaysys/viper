# viper 위성 촬영계획(Tasking) 화면 정의서

- 문서명: viper 위성 촬영계획(Tasking) 화면 정의서
- 프로젝트명: viper
- 버전: v0.3 (다중위성/선호위성/운영재할당 반영)
- 기준일: 2026-02-25
- 기준 문서: `satellite_tasking_ui_case_analysis.md`

## 1. 범위 및 분류 기준

본 정의서는 화면을 다음 두 축으로 분류한다.

- 중요도 분류: `필수(Must)` / `권장(Should)`
- 사용자 분류: `외부요청자`, `내부운영자`, `승인자`, `시스템관리자`

분류 원칙:
- 필수(Must): 서비스 런칭/운영을 위해 즉시 필요한 화면
- 권장(Should): 운영 고도화, 자동화, 재사용성 향상을 위해 도입 권장되는 화면

## 2. 사용자 유형 정의

| 사용자 유형 | 정의 | 주요 책임 |
|---|---|---|
| 외부요청자(Requester) | 촬영을 의뢰하는 사용자 | 요청 생성, 조건 확인, 진행 조회, 결과 수신 |
| 내부운영자(Operator) | 실제 촬영작전 운영 담당자 | 작전 배정/지시, 수신 확인, 예외 대응, 품질 검수 |
| 승인자(Approver) | 비용/정책 승인 책임자 | 견적 승인, 예산 통제, 고위험 변경 승인 |
| 시스템관리자(Admin) | 시스템 정책/권한 관리 | RBAC, 쿼터/계약, 감사로그, 운영정책 관리 |

## 3. 화면 분류 요약

| 화면 ID | 화면명 | 중요도 | 주요 사용자 |
|---|---|---|---|
| SCR-001 | 대시보드 | 필수 | 외부요청자(요약형), 내부운영자, 승인자, 관리자 |
| SCR-002 | 촬영요청 생성(위저드) | 필수 | 외부요청자, 내부운영자, 시스템관리자(운영대행) |
| SCR-003 | 타당성·성공확률 | 필수 | 외부요청자, 내부운영자, 승인자/관리자(조회) |
| SCR-004 | 견적·승인 | 필수 | 외부요청자, 승인자, 내부운영자 |
| SCR-005 | 주문/작전 모니터링 | 필수 | 외부요청자, 내부운영자, 승인자 |
| SCR-006 | 요청 상세·캡처 검수 | 필수 | 내부운영자(검수), 외부요청자/승인자/관리자(조회) |
| SCR-009 | 작전지시(위성 Uplink) | 필수 | 내부운영자(실행), 승인자/관리자(조회) |
| SCR-010 | 수신·처리·QA 모니터링 | 필수 | 내부운영자(조치), 승인자/관리자(조회) |
| SCR-007 | 템플릿·재사용 | 권장 | 외부요청자, 내부운영자 (승인자/관리자 조회) |
| SCR-008 | 관리자 설정 | 권장 | 시스템관리자 |

## 4. 사용자별 필수 화면 매트릭스

| 사용자 유형 | 필수 화면 |
|---|---|
| 외부요청자 | SCR-001(요약), SCR-002, SCR-003, SCR-004, SCR-005, SCR-006(조회) |
| 내부운영자 | SCR-001, SCR-002, SCR-003, SCR-004, SCR-005, SCR-006, SCR-009, SCR-010 |
| 승인자 | SCR-001, SCR-003(조회), SCR-004, SCR-005, SCR-006(조회), SCR-009/010(조회) |
| 시스템관리자 | SCR-001, SCR-002~SCR-010(운영대행/감사 조회), SCR-008 |

참고:
- SCR-008은 전체 서비스 관점에선 권장이나, 운영 규모가 커지면 실질 필수로 승격 가능.
- SCR-009/010은 외부 공개 UI가 아니라 내부 운영 콘솔로 분리 권장.

## 5. 공통 UI/데이터 원칙

- 공통 검색: 기간, 상태, 센서유형(EO/SAR), 우선순위, 요청자, AOI 필터 제공
- 공통 상태값: `Draft`, `Requested`, `Approved`, `Tasked`, `Acquired`, `Downlinked`, `Processing`, `QA`, `Delivered`, `Completed`, `Failed`, `Cancelled`
- 공통 시간 처리: UTC 저장, 화면 표시는 사용자 타임존 기준
- 공통 감사 항목: 생성자/수정자/수정시각/승인이력/변경사유 저장
- 공통 알림 채널: Email, Webhook, In-App

## 6. 화면별 상세 정의

### 6.1 SCR-001 대시보드 (필수)

- 목적: 당일 운영 우선순위와 지연/장애 상황 즉시 파악
- 주요 기능
- KPI 카드: 당일 요청 수, 진행중, 완료, 실패, 평균 리드타임, 긴급건
- 경보 위젯: SLA 위반 임박, 만료 임박 윈도우, 반려 증가 추세
- 지도 위젯: AOI 분포, 상태별 색상 오버레이
- 검증/규칙
- KPI 집계 지연 5분 초과 시 "데이터 지연" 배지 표시

### 6.2 SCR-002 촬영요청 생성(위저드) (필수)

- 목적: 표준화된 단계로 오류 없는 요청 생성
- 단계 구성
- Step1 기본정보: 요청명, 우선순위, 고객/프로젝트, EO/SAR, 단일/반복 촬영
- Step2 AOI: 점/선/폴리곤 입력 및 지도 드로잉
- Step3 시간: 촬영 시작/종료, 타임존, 반복주기
- Step4 제약조건: EO/SAR별 파라미터 입력
- Step5 산출물/전달: 해상도, 밴드, 처리레벨, 포맷, 압축, 전달 위치
- Step6 알림/검토: 알림 채널, 운영자 지정, 요약 확인 후 제출
- Step7 선호 위성(선택): 요청자 선호 위성(`preferred_satellite_ids`) 최대 3개 지정
- 검증/규칙
- AOI: 최소/최대 면적, 최소 폭, 최대 vertex 수 검증
- 시간: 최소 lead time, 최소 window 길이, 최대 미래일 검증
- 파라미터: 상품/모드별 허용 범위 외 입력 차단
- 선호 위성: 센서 일치 + 정비중(MAINTENANCE) 제외 + 중복 금지 + 최소 1개 유효 후보 필요

### 6.3 SCR-003 타당성·성공확률 (필수)

- 목적: 요청 생성 후 실행 가능성 판단으로 실패 비용 최소화
- 주요 기능
- 시간창별 성공확률(높음/중간/낮음)
- 대체 시간창 추천(Top N)
- 제약조건 완화 시뮬레이션
- 검증/규칙
- 산출 근거 모델 버전 기록
- 추천안 채택 시 원안 대비 diff 저장
- 데이터 생성 주체: 백엔드 타당성 엔진(프런트는 requestId 기반 조회)

### 6.4 SCR-004 견적·승인 (필수)

- 목적: 비용/정책/승인 책임 명확화
- 주요 기능
- 예상비용 산출(기본비용 + 옵션비용 + SLA 가산)
- 취소/변경 가능 시점 및 패널티 표시
- 승인 워크플로우(요청자 -> 검토자 -> 승인자)
- 검증/규칙
- 예산 한도 초과 시 상위 승인자 자동 상신
- 승인 완료 전 작전지시(SCR-009) 진입 차단

### 6.5 SCR-005 주문/작전 모니터링 (필수)

- 목적: 요청별 진행 상태 추적 및 예외 대응
- 주요 기능
- 테이블/지도 전환
- 상태 타임라인(요청 -> 승인 -> 지시 -> 촬영 -> 수신 -> 처리 -> 전달 -> 종료)
- 부분충족/미충족 사유 및 잔여 커버리지 표시
- 검증/규칙
- 지연 임계치 초과 시 자동 알림
- 상태 역행 업데이트 금지

### 6.6 SCR-006 요청 상세·캡처 검수 (필수)

- 목적: 캡처 단위 품질 검토 및 재촬영 판단
- 주요 기능
- 촬영 메타 확인(촬영시각, 해상도, cloud/noise 등)
- 품질평가(승인/반려/재검토), 재촬영 요청
- 전달 이력 및 재전달 실행
- 검증/규칙
- 반려 시 사유 코드 필수
- 재촬영 요청 시 원 요청 trace ID 필수

### 6.7 SCR-009 작전지시(위성 Uplink) (필수, 내부운영 전용)

- 목적: 승인된 촬영계획을 실제 위성 운영계로 지시/전송
- 주요 기능
- 지시대상 선택: 위성/센서/패스, 우선순위, 실행윈도우
- 전송 실행: `지시생성 -> 큐등록 -> Uplink 요청 -> Uplink 응답` 단계 표시
- 전송 결과: 성공/실패 코드, 재전송 버튼, 에스컬레이션
- 운영자 재할당: 요청/위성/시각 조합으로 재할당 시뮬레이션(ALLOW/DENY 사유 표시)
- 출력
- 지시 ID, Uplink 시각, 응답 코드, 운영자, 재시도 횟수
- 검증/규칙
- 승인 상태(`Approved`)가 아니면 전송 불가
- 요청 센서와 위성 센서 일치 필수
- 위성 상태(`AVAILABLE`) + 연락창(contact window) + 일일 용량(capacity) 충족 필수
- Uplink 실패 연속 N회 초과 시 자동 에스컬레이션
- 사용자 메모
- 내부운영자 실행, 승인자는 조회 중심으로 참여

### 6.8 SCR-010 수신·처리·QA 모니터링 (필수, 내부운영 전용)

- 목적: 촬영결과 수신 완료 여부와 처리/품질 상태를 운영 관점에서 관리
- 주요 기능
- 수신 확인: downlink 수신 여부, 수신시각, 데이터 무결성(checksum)
- 처리 파이프라인: ingest -> orthorectify -> product generation 진행률
- QA 판정: pass/fail/conditional, 재처리/재촬영 트리거
- 출력
- 수신상태, 처리상태, QA 결과, 납품 가능 여부
- 검증/규칙
- checksum 불일치 시 납품 차단
- QA fail 시 자동으로 SCR-006 재검토 큐 생성
- 사용자 메모
- 내부운영자 조치, 승인자는 조회 중심으로 참여

### 6.9 SCR-007 템플릿·재사용 (권장)

- 목적: 반복 요청 업무 효율화
- 주요 기능
- 기존 요청 복제
- 템플릿 저장/버전관리
- 템플릿 공유 범위 설정(개인/조직)

### 6.10 SCR-008 관리자 설정 (권장)

- 목적: 운영 정책 및 접근통제 중앙관리
- 주요 기능
- 계약/쿼터/크레딧 설정
- RBAC 및 승인선 정책
- 기본 전달 경로 및 알림 정책 설정
- 감사로그 조회/내보내기

## 7. 필수 검증 로직 정의

| 규칙 ID | 규칙명 | 적용 화면 | 검증 조건 | 실패 시 처리 |
|---|---|---|---|---|
| VAL-001 | AOI 면적/형상 검증 | SCR-002 | 최소/최대 면적, 최소 폭, 최대 vertex | 저장/제출 차단 + 오류 가이드 |
| VAL-002 | 시간창 검증 | SCR-002 | 최소 lead time, 최소 window 길이, 최대 미래일 | 제출 차단 + 허용 범위 제안 |
| VAL-003 | 파라미터 호환성 | SCR-002/SCR-003 | 센서/상품/모드별 허용값 일치 | 불일치 항목 하이라이트 |
| VAL-004 | 승인 선행 검증 | SCR-004/SCR-009 | 승인완료 여부, 예산/정책 충족 | 지시 전송 차단 |
| VAL-005 | 상태 전이 무결성 | SCR-005/SCR-009/SCR-010 | 정의된 상태 전이 규칙 준수 | 업데이트 거부 + 감사로그 |
| VAL-006 | 검수 사유 필수 | SCR-006 | 반려/재검토 시 사유코드 필수 | 저장 차단 |
| VAL-007 | Uplink 응답 검증 | SCR-009 | 전송 응답코드/ACK 정상 수신 | 자동 재시도 + 운영자 알림 |
| VAL-008 | 수신 무결성 검증 | SCR-010 | checksum 및 필수 메타데이터 일치 | 납품 차단 + 재수신/재처리 |

## 8. 권한(RBAC) 초안

| 역할 | SCR-001 | SCR-002 | SCR-003 | SCR-004 | SCR-005 | SCR-006 | SCR-009 | SCR-010 | SCR-007 | SCR-008 |
|---|---|---|---|---|---|---|---|---|---|---|
| 외부요청자(Requester) | R | C/U | R | R | R | R | - | - | C/U | - |
| 내부운영자(Operator) | R | C/U | R | R | R/U | C/U | C/U | R/U | C/U | - |
| 승인자(Approver) | R | - | R | A | R | R | R | R | R | - |
| 시스템관리자(Admin) | R | C/U | R | R/A | R | R | R | R | R | C/U/D |

- 권한 표기: `R` 조회, `C` 생성, `U` 수정, `D` 삭제, `A` 승인
- 권장 정책: SCR-009/010은 외부요청자 접근 불가(내부망/VPN + MFA)

## 9. 비기능 요구사항(초안)

- 성능: 주요 목록 화면 3초 이내(95 percentile)
- 가용성: 업무시간 기준 99.5% 이상
- 보안: 모든 전달 링크 만료시간/서명 URL 적용
- 추적성: 상태 변경/승인/지시/수신/검수 모든 액션 감사로그 보관
- 운영안정성: 지시 전송 및 수신 단계에 재시도/중복방지(idempotency key) 적용

## 10. 4 Actor / 10 Screen End-to-End Use Case

트리거: 외부요청자(Requester)가 `SCR-002 촬영요청 생성`에서 요청을 제출한다.

### 10.1 Actor별 담당 흐름

| Actor | 주요 사용 화면 | 담당 흐름 |
|---|---|---|
| 외부요청자(Requester) | SCR-001, SCR-002, SCR-003, SCR-004, SCR-005, SCR-006, SCR-007(권장) | 요청 생성/제출, 타당성 확인, 견적 확인, 진행/결과 조회 |
| 내부운영자(Operator) | SCR-001, SCR-003, SCR-004, SCR-005, SCR-006, SCR-009, SCR-010, SCR-007(권장) | 운영 검토, 작전지시 전송, 수신/QA 처리, 재검토/재촬영 판단 |
| 승인자(Approver) | SCR-001, SCR-004, SCR-005 (SCR-009/010 조회) | 비용/정책/예산 승인 또는 반려, 승인 후 진행 모니터링 |
| 시스템관리자(Admin) | SCR-001, SCR-008 (+운영 대행) | RBAC/쿼터/승인선/감사로그 관리, 정책 통제 |

### 10.2 Actor별 설명식 사용 흐름 (`->`)

- 외부요청자(Requester)
`SCR-001(요약 대시보드)` -> `SCR-002(촬영요청 생성/제출)` -> `SCR-003(타당성 확인)` -> `SCR-004(견적 확인/승인요청)` -> `SCR-005(진행 모니터링)` -> `SCR-006(결과/캡처 확인)` -> 필요 시 `SCR-007(템플릿 재사용)`

- 내부운영자(Operator)
`SCR-001(운영 대시보드)` -> `SCR-003(타당성 상세 검토)` -> `SCR-004(승인상태 확인)` -> `SCR-009(위성 Uplink 지시 전송)` -> `SCR-010(수신/처리/QA 확인)` -> 필요 시 `SCR-006(재검토/재촬영 판단)` -> `SCR-005(전체 상태 추적)` -> 필요 시 `SCR-007(운영 템플릿 관리)`

- 승인자(Approver)
`SCR-001(승인 대시보드)` -> `SCR-004(견적/정책/예산 승인 또는 반려)` -> `SCR-005(승인 후 진행 모니터링)` -> 필요 시 `SCR-009/010(조회)`

- 시스템관리자(Admin)
`SCR-001(관리 관점 대시보드)` -> `SCR-008(RBAC/쿼터/승인선/감사로그 관리)` -> 필요 시 운영 대행으로 `SCR-002~SCR-010` 조회/조치

### 10.3 메인 정상 시나리오

1. Requester가 `SCR-002`에서 촬영요청 제출
2. Backend가 타당성/성공확률 계산 결과를 생성
3. Operator/Requester가 `SCR-003`에서 타당성/성공확률 확인
4. Approver가 `SCR-004`에서 견적/정책 기준 승인
5. Operator가 `SCR-009`에서 위성 작전지시(Uplink) 전송
6. Operator가 `SCR-010`에서 수신/처리/QA 확인
7. Requester가 `SCR-005`, `SCR-006`에서 진행/결과 확인 후 종료

### 10.4 주요 비정상 분기

1. `SCR-003`에서 성공확률 낮음(LOW): 대체 시간창/제약완화 후 재평가
2. `SCR-004` 미승인: `SCR-009` 작전지시 진입/실행 차단
3. `SCR-009` Uplink 실패: 재시도/에스컬레이션
4. `SCR-010` checksum 불일치 또는 QA Fail: 납품 차단, `SCR-006` 재검토/재촬영 연계

## 11. 산출물 및 다음 단계

- 본 문서는 사용자 유형 구분 + 다중위성/선호위성/재할당 반영 버전(v0.3)
- 다음 단계 권고
- 사용자별 메뉴 트리(포털/운영콘솔 분리) 확정
- 화면별 와이어프레임 및 상태 전이 다이어그램
- API I/O 스키마(OpenAPI)와 화면 필드 매핑
- 예외 시나리오 테스트케이스(Uplink 실패, Downlink 지연, QA Fail)
